import{_ as A,d as L,f as R,r as n,aW as q,o as T,j as g,k as $,w as o,az as O,D as s,l as a,aB as p,A as N,aI as k,aJ as u,n as y,aD as S,B as v,N as C,b2 as B,C as j,p as E}from"./index.3c170ecb.js";import{Q as M}from"./QSpinnerDots.14365e0b.js";import{u as W}from"./notary.66e50f09.js";import{u as H}from"./user.df2ed8b2.js";import{u as K}from"./useNotifications.f09085c4.js";import"./notification.f898a54a.js";const X={class:"row q-col-gutter-md"},Y={class:"col-12 col-md-6"},Z={class:"row q-col-gutter-md"},ee={class:"col-12 col-md-6"},le={class:"col-12 col-md-6"},ae={class:"col-12 col-md-6"},se={class:"col-12 col-md-6"},oe={class:"col-12"},ie={class:"col-12 col-md-6"},te={class:"row q-col-gutter-md"},re={class:"col-12 col-md-6"},de={class:"col-12 col-md-6"},ne={class:"col-12"},me={class:"row"},ue={class:"col-12 col-md-6"},ce={class:"row q-col-gutter-md"},_e={class:"col-12 q-mb-md"},pe={key:0,class:"signature-preview q-mb-md"},fe={key:1,class:"text-grey q-mb-md"},ge={class:"col-12"},ye={class:"col-12"},ve={class:"col-12 col-md-6"},be={class:"row q-col-gutter-md"},xe={class:"col-12 q-mb-md"},Ve={key:0,class:"seal-preview q-mb-md"},Pe={key:1,class:"text-grey q-mb-md"},he={class:"col-12"},we={class:"col-12"},qe=L({__name:"ProfilePage",setup(Ne){R();const b=W(),x=H(),{showNotification:d}=K(),U=n(!1),V=n(!1),P=n(!1),h=n(!1),w=n(!1),t=q({user_id:0,first_name:"",middle_name:"",last_name:"",email:"",mobile_number:"",address:"",has_digital_signature:!1,has_digital_seal:!1,notary_commission_number:"",notary_commission_expiry:""}),i=q({first_name:"",middle_name:"",last_name:"",mobile_number:"",address:""}),m=q({notary_commission_number:"",notary_commission_expiry:""}),c=n(null),_=n(null),F=n(""),D=n(""),f=async()=>{U.value=!0;try{const r=await x.fetchProfile(),e=await b.fetchNotaryProfile();Object.assign(t,r),e&&(t.notary_commission_number=e.notary_commission_number,t.notary_commission_expiry=e.notary_commission_expiry,t.has_digital_seal=e.has_digital_seal),i.first_name=t.first_name,i.middle_name=t.middle_name||"",i.last_name=t.last_name,i.mobile_number=t.mobile_number,i.address=t.address,m.notary_commission_number=t.notary_commission_number||"",m.notary_commission_expiry=t.notary_commission_expiry||"",t.has_digital_signature&&(F.value=`/api/v1/users/signature?${new Date().getTime()}`),t.has_digital_seal&&(D.value=`/api/v1/notary/seal?${new Date().getTime()}`)}catch(r){console.error("Error loading profile:",r),d({type:"negative",message:"Failed to load profile information"})}finally{U.value=!1}},G=async()=>{V.value=!0;try{await x.updateProfile(i),d({type:"positive",message:"Profile updated successfully"}),await f()}catch(r){console.error("Error updating profile:",r),d({type:"negative",message:"Failed to update profile"})}finally{V.value=!1}},I=async()=>{P.value=!0;try{await b.updateNotaryProfile(m),d({type:"positive",message:"Notary commission details updated successfully"}),await f()}catch(r){console.error("Error updating notary profile:",r),d({type:"negative",message:"Failed to update notary commission details"})}finally{P.value=!1}},z=async()=>{if(!!c.value){h.value=!0;try{await x.uploadSignature(c.value),d({type:"positive",message:"Digital signature uploaded successfully"}),c.value=null,await f()}catch(r){console.error("Error uploading signature:",r),d({type:"negative",message:"Failed to upload digital signature"})}finally{h.value=!1}}},J=async()=>{if(!!_.value){w.value=!0;try{await b.uploadSeal(_.value),d({type:"positive",message:"Digital seal uploaded successfully"}),_.value=null,await f()}catch(r){console.error("Error uploading seal:",r),d({type:"negative",message:"Failed to upload digital seal"})}finally{w.value=!1}}},Q=r=>{r.forEach(e=>{let l="";e.failedPropValidation==="accept"?l="File type not allowed. Please use JPG or PNG format.":e.failedPropValidation==="max-file-size"?l="File is too large. Maximum size is 2MB.":l="File upload failed.",d({type:"negative",message:l})})};return T(async()=>{await f()}),(r,e)=>(g(),$(O,{padding:""},{default:o(()=>[s("div",X,[e[16]||(e[16]=s("div",{class:"col-12"},[s("h4",{class:"q-mt-none q-mb-md"},"Notary Profile")],-1)),s("div",Y,[a(S,{flat:"",bordered:""},{default:o(()=>[a(p,null,{default:o(()=>e[9]||(e[9]=[s("div",{class:"text-h6"},"Profile Information",-1)])),_:1}),a(N),a(p,{class:"q-gutter-md"},{default:o(()=>[a(k,{onSubmit:G,class:"q-gutter-md"},{default:o(()=>[s("div",Z,[s("div",ee,[a(u,{filled:"",modelValue:i.first_name,"onUpdate:modelValue":e[0]||(e[0]=l=>i.first_name=l),label:"First Name",rules:[l=>!!l||"First name is required"]},null,8,["modelValue","rules"])]),s("div",le,[a(u,{filled:"",modelValue:i.middle_name,"onUpdate:modelValue":e[1]||(e[1]=l=>i.middle_name=l),label:"Middle Name"},null,8,["modelValue"])]),s("div",ae,[a(u,{filled:"",modelValue:i.last_name,"onUpdate:modelValue":e[2]||(e[2]=l=>i.last_name=l),label:"Last Name",rules:[l=>!!l||"Last name is required"]},null,8,["modelValue","rules"])]),s("div",se,[a(u,{filled:"",modelValue:i.mobile_number,"onUpdate:modelValue":e[3]||(e[3]=l=>i.mobile_number=l),label:"Mobile Number",rules:[l=>!!l||"Mobile number is required"]},null,8,["modelValue","rules"])]),s("div",oe,[a(u,{filled:"",modelValue:i.address,"onUpdate:modelValue":e[4]||(e[4]=l=>i.address=l),label:"Address",type:"textarea",rules:[l=>!!l||"Address is required"]},null,8,["modelValue","rules"])])]),a(y,{type:"submit",color:"primary",label:"Update Profile",loading:V.value},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),s("div",ie,[a(S,{flat:"",bordered:""},{default:o(()=>[a(p,null,{default:o(()=>e[10]||(e[10]=[s("div",{class:"text-h6"},"Notary Commission Details",-1)])),_:1}),a(N),a(p,{class:"q-gutter-md"},{default:o(()=>[a(k,{onSubmit:I,class:"q-gutter-md"},{default:o(()=>[s("div",te,[s("div",re,[a(u,{filled:"",modelValue:m.notary_commission_number,"onUpdate:modelValue":e[5]||(e[5]=l=>m.notary_commission_number=l),label:"Commission Number",rules:[l=>!!l||"Commission number is required"]},null,8,["modelValue","rules"])]),s("div",de,[a(u,{filled:"",modelValue:m.notary_commission_expiry,"onUpdate:modelValue":e[6]||(e[6]=l=>m.notary_commission_expiry=l),label:"Commission Expiry",type:"date",rules:[l=>!!l||"Expiry date is required"]},null,8,["modelValue","rules"])])]),a(y,{type:"submit",color:"primary",label:"Update Commission Details",loading:P.value},null,8,["loading"])]),_:1})]),_:1})]),_:1})]),s("div",ne,[a(S,{flat:"",bordered:""},{default:o(()=>[a(p,null,{default:o(()=>e[11]||(e[11]=[s("div",{class:"text-h6"},"Digital Signature and Seal",-1)])),_:1}),a(N),a(p,null,{default:o(()=>[s("div",me,[s("div",ue,[e[13]||(e[13]=s("div",{class:"text-subtitle1 q-mb-md"},"Digital Signature",-1)),s("div",ce,[s("div",_e,[t.has_digital_signature?(g(),v("div",pe,[a(C,{src:F.value,style:{"max-width":"300px","max-height":"150px",border:"1px solid #ddd","background-color":"#f9f9f9"}},{loading:o(()=>[a(M,{color:"primary"})]),_:1},8,["src"])])):(g(),v("div",fe," No digital signature uploaded "))]),s("div",ge,[a(B,{filled:"",modelValue:c.value,"onUpdate:modelValue":e[7]||(e[7]=l=>c.value=l),label:"Upload Signature",accept:".jpg, .jpeg, .png","max-file-size":2097152,onRejected:Q},{prepend:o(()=>[a(j,{name:"attach_file"})]),hint:o(()=>e[12]||(e[12]=[E(" JPG or PNG, max 2MB ")])),_:1},8,["modelValue"])]),s("div",ye,[a(y,{color:"primary",label:"Upload Signature",disable:!c.value,loading:h.value,onClick:z},null,8,["disable","loading"])])])]),s("div",ve,[e[15]||(e[15]=s("div",{class:"text-subtitle1 q-mb-md"},"Digital Seal",-1)),s("div",be,[s("div",xe,[t.has_digital_seal?(g(),v("div",Ve,[a(C,{src:D.value,style:{"max-width":"300px","max-height":"150px",border:"1px solid #ddd","background-color":"#f9f9f9"}},{loading:o(()=>[a(M,{color:"primary"})]),_:1},8,["src"])])):(g(),v("div",Pe," No digital seal uploaded "))]),s("div",he,[a(B,{filled:"",modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),label:"Upload Seal",accept:".jpg, .jpeg, .png","max-file-size":2097152,onRejected:Q},{prepend:o(()=>[a(j,{name:"attach_file"})]),hint:o(()=>e[14]||(e[14]=[E(" JPG or PNG, max 2MB ")])),_:1},8,["modelValue"])]),s("div",we,[a(y,{color:"primary",label:"Upload Seal",disable:!_.value,loading:w.value,onClick:J},null,8,["disable","loading"])])])])])]),_:1})]),_:1})])])]),_:1}))}});var Ce=A(qe,[["__scopeId","data-v-2b69e0a1"]]);export{Ce as default};
