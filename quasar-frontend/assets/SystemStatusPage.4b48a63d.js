import{ax as lt,ay as T,_ as ot,d as rt,r as v,aW as $,o as it,j as f,k as F,l as a,az as nt,b3 as ut,bD as dt,F as s,m as t,aB as u,C as p,D as b,aC as z,E as L,aK as ct,t as m,p as w,aD as x,A as R,I as S,J as g,B as d,q as i,bv as mt,bE as ft,bu as M,y as gt,aI as yt,aM as pt,aJ as _t,H as vt,aY as bt,S as ht}from"./index.db3945b0.js";import{d as j}from"./date.7aef48e4.js";import{u as wt}from"./useNotifications.1d84db4d.js";import"./notification.59488b49.js";const St=lt("admin",{state:()=>({systemStatus:{status:"operational",message:"",uptime:0,active_users:0,queue_size:0,average_processing_time:0,server_time:null},statusHistory:[]}),actions:{async fetchSystemStatus(){try{const n=await T.get("/system/status");if(n.data.success)return this.systemStatus=n.data.data,this.systemStatus}catch(n){throw console.error("Error fetching system status:",n),n}},async fetchStatusHistory(n){try{const r=await T.get("/admin/system/status-history",{params:n});if(r.data.success)return this.statusHistory=r.data.data,r.data}catch(r){throw console.error("Error fetching status history:",r),r}},async updateSystemStatus(n){try{const r=await T.post("/admin/system/status",n);if(r.data.success)return r.data}catch(r){throw console.error("Error updating system status:",r),r}},async fetchPerformanceData(){try{const n=new Date,r=[],y=[],D=[];for(let h=23;h>=0;h--){const k=new Date(n);k.setHours(n.getHours()-h),r.push(k.getHours()+":00"),y.push(Math.floor(Math.random()*100)+50),D.push(Math.floor(Math.random()*20)+5)}return{users:{labels:r,data:y},times:{labels:r,data:D}}}catch(n){throw console.error("Error fetching performance data:",n),n}}}});const Dt={class:"row q-col-gutter-md"},kt={class:"col-12"},Ct={class:"row q-col-gutter-md"},qt={class:"col-12 col-md-4"},xt={key:0,class:"q-pa-md"},Mt={key:1},Qt={class:"text-body2 q-mt-sm"},At={class:"text-caption q-mt-md"},Pt={class:"col-12 col-md-4"},zt={class:"col-12 col-md-4"},Lt={class:"row q-col-gutter-md"},Ut={class:"col-6"},Et={class:"col-6"},Ht={class:"col-6"},Vt={class:"col-6"},It={class:"col-12"},Yt={class:"row q-col-gutter-md"},Tt={class:"col-12 col-md-6"},Ft={key:0,class:"chart-placeholder"},jt={key:1,class:"chart-container"},Ot={class:"col-12 col-md-6"},Bt={key:0,class:"chart-placeholder"},Nt={key:1,class:"chart-container"},$t={class:"col-12"},Rt={key:0,class:"text-center q-pa-lg"},Jt={key:1},Zt={class:"row justify-end q-mt-md"},Kt=rt({__name:"SystemStatusPage",setup(n){const r=St(),{showNotification:y}=wt(),D=v(null),h=v(null);let k=null,V=null;const Q=v(!1),I=v(!1),U=v(!1),A=v(!1),c=$({status:"operational",message:"",uptime:0,active_users:0,queue_size:0,average_processing_time:0,server_time:null}),O=v([]),P=v(!1),_=$({status:"operational",message:""}),J=[{label:"Operational",value:"operational"},{label:"Degraded Performance",value:"degraded"},{label:"Partial Outage",value:"partial_outage"},{label:"Major Outage",value:"major_outage"},{label:"Maintenance",value:"maintenance"}],Z=[{name:"status",label:"Status",field:"status",align:"left",sortable:!0},{name:"message",label:"Message",field:"message",align:"left",sortable:!0},{name:"active_users",label:"Active Users",field:"active_users",align:"right",sortable:!0},{name:"queue_size",label:"Queue Size",field:"queue_size",align:"right",sortable:!0},{name:"average_processing_time",label:"Avg. Time (min)",field:"average_processing_time",align:"right",sortable:!0},{name:"created_at",label:"Timestamp",field:"created_at",align:"left",sortable:!0}],E=async()=>{Q.value=!0;try{const l=await r.fetchSystemStatus();Object.assign(c,l)}catch(l){console.error("Error loading system status:",l),y({type:"negative",message:"Failed to load system status"})}finally{Q.value=!1}},H=async()=>{I.value=!0;try{const l=new Date,e=new Date;e.setDate(e.getDate()-7);const o={start_date:j.formatDate(e,"YYYY-MM-DD"),end_date:j.formatDate(l,"YYYY-MM-DD"),page:1,per_page:20},C=await r.fetchStatusHistory(o);O.value=C.data||[]}catch(l){console.error("Error loading status history:",l),y({type:"negative",message:"Failed to load status history"})}finally{I.value=!1}},K=async()=>{U.value=!0;try{const l=await r.fetchPerformanceData();await ut(),W(l)}catch(l){console.error("Error loading chart data:",l),y({type:"negative",message:"Failed to load performance charts"})}finally{U.value=!1}},W=async l=>{if(!D.value||!h.value)return;k&&k.destroy(),V&&V.destroy();const{Chart:e,registerables:o}=await dt(()=>import("./chart.6d6733bd.js"),[]);e.register(...o);const C=D.value.getContext("2d"),q=h.value.getContext("2d");k=new e(C,{type:"line",data:{labels:l.users.labels,datasets:[{label:"Active Users",data:l.users.data,borderColor:"#1976D2",backgroundColor:"rgba(25, 118, 210, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}}),V=new e(q,{type:"line",data:{labels:l.times.labels,datasets:[{label:"Processing Time (min)",data:l.times.data,borderColor:"#FF9800",backgroundColor:"rgba(255, 152, 0, 0.1)",fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})},B=l=>l?j.formatDate(l,"MMM D, YYYY h:mm A"):"N/A",G=l=>{if(!l)return"N/A";const e=Math.floor(l/86400),o=Math.floor(l%86400/3600),C=Math.floor(l%3600/60);let q="";return e>0&&(q+=`${e} day${e>1?"s":""} `),(o>0||e>0)&&(q+=`${o} hour${o>1?"s":""} `),q+=`${C} minute${C>1?"s":""}`,q},X=l=>({operational:"check_circle",degraded:"warning",partial_outage:"error",major_outage:"dangerous",maintenance:"build"})[l]||"help",Y=l=>({operational:"positive",degraded:"warning",partial_outage:"orange",major_outage:"negative",maintenance:"blue"})[l]||"grey",N=l=>({operational:"Operational",degraded:"Degraded Performance",partial_outage:"Partial Outage",major_outage:"Major Outage",maintenance:"Maintenance"})[l]||"Unknown",tt=()=>{_.status=c.status,_.message=c.message||"",P.value=!0},et=async()=>{A.value=!0;try{await r.updateSystemStatus(_),y({type:"positive",message:"System status updated successfully"}),P.value=!1,await E(),await H()}catch(l){console.error("Error updating system status:",l),y({type:"negative",message:"Failed to update system status"})}finally{A.value=!1}},at=()=>{_.status="maintenance",_.message="System is under maintenance. Some features may be unavailable.",P.value=!0},st=async()=>{A.value=!0;try{const l={status:"operational",message:"All systems operational."};await r.updateSystemStatus(l),y({type:"positive",message:"System status set to operational"}),await E(),await H()}catch(l){console.error("Error updating system status:",l),y({type:"negative",message:"Failed to update system status"})}finally{A.value=!1}};return it(async()=>{await E(),await H(),await K()}),(l,e)=>(f(),F(nt,{padding:""},{default:a(()=>[s("div",Dt,[e[26]||(e[26]=s("div",{class:"col-12"},[s("h4",{class:"q-mt-none q-mb-md"},"System Status Dashboard")],-1)),s("div",kt,[s("div",Ct,[s("div",qt,[t(x,{flat:"",bordered:"",class:"system-status-card"},{default:a(()=>[t(u,null,{default:a(()=>e[3]||(e[3]=[s("div",{class:"text-h6"},"System Status",-1)])),_:1}),t(p),t(u,{class:"q-py-lg text-center"},{default:a(()=>[Q.value?(f(),b("div",xt,[t(z,{color:"primary",size:"3em"}),e[4]||(e[4]=s("div",{class:"q-mt-sm"},"Loading system status...",-1))])):(f(),b("div",Mt,[t(L,{name:X(c.status),color:Y(c.status),size:"4em"},null,8,["name","color"]),s("div",{class:ct(["text-h5 q-mt-md",`text-${Y(c.status)}`])},m(N(c.status)),3),s("div",Qt,m(c.message||"All systems are operating normally."),1),s("div",At," Last updated: "+m(B(c.server_time)),1)]))]),_:1}),t(p),t(u,null,{default:a(()=>[t(w,{color:"primary",label:"Update Status",class:"full-width",onClick:tt})]),_:1})]),_:1})]),s("div",Pt,[t(x,{flat:"",bordered:"",class:"full-height"},{default:a(()=>[t(u,null,{default:a(()=>e[5]||(e[5]=[s("div",{class:"text-h6"},"System Metrics",-1)])),_:1}),t(p),Q.value?(f(),F(u,{key:0,class:"q-py-lg text-center"},{default:a(()=>[t(z,{color:"primary",size:"3em"}),e[6]||(e[6]=s("div",{class:"q-mt-sm"},"Loading metrics...",-1))]),_:1})):(f(),F(R,{key:1,padding:""},{default:a(()=>[t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[7]||(e[7]=[i("Uptime")])),_:1}),t(d,{caption:""},{default:a(()=>[i(m(G(c.uptime)),1)]),_:1})]),_:1}),t(g,{side:""},{default:a(()=>[t(L,{name:"timer",color:"primary"})]),_:1})]),_:1}),t(p,{spaced:"",inset:""}),t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[8]||(e[8]=[i("Active Users")])),_:1}),t(d,{caption:""},{default:a(()=>[i(m(c.active_users||0)+" users online",1)]),_:1})]),_:1}),t(g,{side:""},{default:a(()=>[t(L,{name:"people",color:"primary"})]),_:1})]),_:1}),t(p,{spaced:"",inset:""}),t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[9]||(e[9]=[i("Queue Size")])),_:1}),t(d,{caption:""},{default:a(()=>[i(m(c.queue_size||0)+" documents in queue",1)]),_:1})]),_:1}),t(g,{side:""},{default:a(()=>[t(L,{name:"queue",color:"primary"})]),_:1})]),_:1}),t(p,{spaced:"",inset:""}),t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[10]||(e[10]=[i("Processing Time")])),_:1}),t(d,{caption:""},{default:a(()=>[i(m(c.average_processing_time||0)+" minutes avg.",1)]),_:1})]),_:1}),t(g,{side:""},{default:a(()=>[t(L,{name:"speed",color:"primary"})]),_:1})]),_:1})]),_:1}))]),_:1})]),s("div",zt,[t(x,{flat:"",bordered:"",class:"full-height"},{default:a(()=>[t(u,null,{default:a(()=>e[11]||(e[11]=[s("div",{class:"text-h6"},"Quick Actions",-1)])),_:1}),t(p),t(u,null,{default:a(()=>[s("div",Lt,[s("div",Ut,[t(w,{color:"primary",icon:"refresh",label:"Refresh Data",flat:"",class:"full-width",loading:Q.value,onClick:E},null,8,["loading"])]),s("div",Et,[t(w,{color:"secondary",icon:"history",label:"View History",flat:"",class:"full-width",onClick:H})]),s("div",Ht,[t(w,{color:"warning",icon:"warning",label:"Maintenance Mode",flat:"",class:"full-width",onClick:at})]),s("div",Vt,[t(w,{color:"positive",icon:"check_circle",label:"All Clear",flat:"",class:"full-width",onClick:st})])])]),_:1}),t(p),t(u,null,{default:a(()=>[e[18]||(e[18]=s("div",{class:"text-subtitle2"},"System Information",-1)),t(R,{dense:""},{default:a(()=>[t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[12]||(e[12]=[i("Version")])),_:1}),t(d,{caption:""},{default:a(()=>e[13]||(e[13]=[i("v1.0.0")])),_:1})]),_:1})]),_:1}),t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[14]||(e[14]=[i("Environment")])),_:1}),t(d,{caption:""},{default:a(()=>e[15]||(e[15]=[i("Production")])),_:1})]),_:1})]),_:1}),t(S,null,{default:a(()=>[t(g,null,{default:a(()=>[t(d,null,{default:a(()=>e[16]||(e[16]=[i("Last Deployment")])),_:1}),t(d,{caption:""},{default:a(()=>e[17]||(e[17]=[i("May 1, 2025")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])])]),s("div",It,[t(x,{flat:"",bordered:""},{default:a(()=>[t(u,null,{default:a(()=>e[19]||(e[19]=[s("div",{class:"text-h6"},"System Performance",-1)])),_:1}),t(p),t(u,null,{default:a(()=>[s("div",Yt,[s("div",Tt,[e[21]||(e[21]=s("div",{class:"text-subtitle2 q-mb-sm"},"Active Users (Last 24 Hours)",-1)),U.value?(f(),b("div",Ft,[t(z,{color:"primary",size:"2em"}),e[20]||(e[20]=s("div",{class:"q-mt-sm"},"Loading chart...",-1))])):(f(),b("div",jt,[s("canvas",{ref_key:"usersChart",ref:D},null,512)]))]),s("div",Ot,[e[23]||(e[23]=s("div",{class:"text-subtitle2 q-mb-sm"},"Processing Times (Last 24 Hours)",-1)),U.value?(f(),b("div",Bt,[t(z,{color:"primary",size:"2em"}),e[22]||(e[22]=s("div",{class:"q-mt-sm"},"Loading chart...",-1))])):(f(),b("div",Nt,[s("canvas",{ref_key:"timesChart",ref:h},null,512)]))])])]),_:1})]),_:1})]),s("div",$t,[t(x,{flat:"",bordered:""},{default:a(()=>[t(u,null,{default:a(()=>e[24]||(e[24]=[s("div",{class:"text-h6"},"Status History",-1)])),_:1}),t(p),t(u,null,{default:a(()=>[I.value?(f(),b("div",Rt,[t(z,{color:"primary",size:"3em"}),e[25]||(e[25]=s("div",{class:"q-mt-sm"},"Loading status history...",-1))])):(f(),b("div",Jt,[t(mt,{rows:O.value,columns:Z,"row-key":"status_id",dense:"",pagination:{rowsPerPage:5}},{body:a(o=>[t(ft,{props:o},{default:a(()=>[t(M,{key:"status",props:o},{default:a(()=>[t(gt,{color:Y(o.row.status)},{default:a(()=>[i(m(N(o.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"]),t(M,{key:"message",props:o},{default:a(()=>[i(m(o.row.message),1)]),_:2},1032,["props"]),t(M,{key:"active_users",props:o},{default:a(()=>[i(m(o.row.active_users),1)]),_:2},1032,["props"]),t(M,{key:"queue_size",props:o},{default:a(()=>[i(m(o.row.queue_size),1)]),_:2},1032,["props"]),t(M,{key:"average_processing_time",props:o},{default:a(()=>[i(m(o.row.average_processing_time)+" min ",1)]),_:2},1032,["props"]),t(M,{key:"created_at",props:o},{default:a(()=>[i(m(B(o.row.created_at)),1)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows"])]))]),_:1})]),_:1})])]),t(bt,{modelValue:P.value,"onUpdate:modelValue":e[2]||(e[2]=o=>P.value=o)},{default:a(()=>[t(x,{style:{"min-width":"350px"}},{default:a(()=>[t(u,null,{default:a(()=>e[27]||(e[27]=[s("div",{class:"text-h6"},"Update System Status",-1)])),_:1}),t(u,null,{default:a(()=>[t(yt,{onSubmit:et,class:"q-gutter-md"},{default:a(()=>[t(pt,{filled:"",modelValue:_.status,"onUpdate:modelValue":e[0]||(e[0]=o=>_.status=o),options:J,label:"Status","emit-value":"","map-options":""},null,8,["modelValue"]),t(_t,{filled:"",modelValue:_.message,"onUpdate:modelValue":e[1]||(e[1]=o=>_.message=o),label:"Status Message",type:"textarea",rows:"3"},null,8,["modelValue"]),s("div",Zt,[vt(t(w,{flat:"",label:"Cancel",color:"primary"},null,512),[[ht]]),t(w,{unelevated:"",label:"Update",color:"primary",type:"submit",loading:A.value,class:"q-ml-sm"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});var ee=ot(Kt,[["__scopeId","data-v-ebb75c9a"]]);export{ee as default};
