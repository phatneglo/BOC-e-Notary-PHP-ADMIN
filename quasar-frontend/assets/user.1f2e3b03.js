import{ax as a,g as o,ay as s,aA as i}from"./index.db3945b0.js";const n=a("user",{state:()=>({user_id:null,profile:null,isLoading:!1,error:null}),getters:{hasDigitalSignature:r=>{var e;return!!((e=r.profile)!=null&&e.has_digital_signature)},fullName:r=>r.profile?r.profile.middle_name?`${r.profile.first_name} ${r.profile.middle_name.charAt(0)}. ${r.profile.last_name}`:`${r.profile.first_name} ${r.profile.last_name}`:""},actions:{async fetchProfile(){this.isLoading=!0,this.error=null;try{const r=o();if(r.user)return this.profile={...r.user},this.user_id=r.user.user_id,this.profile;const e=await s.get("/users/profile");if(e.data.success)return this.profile=e.data.data,this.user_id=this.profile.user_id,this.profile;throw new Error(e.data.message||"Failed to load user profile")}catch(r){throw console.error("Error fetching user profile:",r),this.error=r.message||"An error occurred while fetching user profile",r}finally{this.isLoading=!1}},async updateProfile(r){this.isLoading=!0,this.error=null;try{const e=await s.put("/users/profile",r);if(e.data.success)return this.profile={...this.profile,...r},i.create({type:"positive",message:"Profile updated successfully"}),this.profile;throw new Error(e.data.message||"Failed to update profile")}catch(e){throw console.error("Error updating profile:",e),this.error=e.message||"An error occurred while updating profile",e}finally{this.isLoading=!1}},async uploadSignature(r){this.isLoading=!0,this.error=null;try{const e=new FormData;e.append("signature",r);const t=await s.post("/users/signature",e,{headers:{"Content-Type":"multipart/form-data"}});if(t.data.success)return this.profile={...this.profile,has_digital_signature:!0},i.create({type:"positive",message:"Signature uploaded successfully"}),!0;throw new Error(t.data.message||"Failed to upload signature")}catch(e){throw console.error("Error uploading signature:",e),this.error=e.message||"An error occurred while uploading signature",e}finally{this.isLoading=!1}},async changePassword(r){this.isLoading=!0,this.error=null;try{const e=await s.put("/users/password",r);if(e.data.success)return i.create({type:"positive",message:"Password changed successfully"}),!0;throw new Error(e.data.message||"Failed to change password")}catch(e){throw console.error("Error changing password:",e),this.error=e.message||"An error occurred while changing password",e}finally{this.isLoading=!1}},async fetchActivity(){this.isLoading=!0,this.error=null;try{const r=await s.get("/users/activity");if(r.data.success)return r.data.data;throw new Error(r.data.message||"Failed to load activity")}catch(r){throw console.error("Error fetching activity:",r),this.error=r.message||"An error occurred while fetching activity",r}finally{this.isLoading=!1}}}});export{n as u};
