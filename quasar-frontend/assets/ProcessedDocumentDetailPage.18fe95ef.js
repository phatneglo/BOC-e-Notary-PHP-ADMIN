import{_ as Y,d as T,c as h,e as O,r as x,o as K,j as c,k as p,l as t,az as U,aA as v,F as s,m as e,p as y,D as g,aC as I,aD as _,E as Q,aB as f,aK as $,A as D,I as r,J as u,B as n,q as i,t as d,y as P,s as S}from"./index.db3945b0.js";import{d as A}from"./date.7aef48e4.js";import{N as q}from"./notarized.378431f1.js";const G={class:"content-container q-pa-md q-pb-xl"},J={class:"row items-center q-mb-md"},H={class:"col"},W={class:"row items-center q-mb-xs"},X={class:"col-auto"},Z={key:0,class:"q-pa-xl flex flex-center"},ee={key:2,class:"row q-col-gutter-md"},te={class:"col-12 col-md-4"},ae={key:0,class:"q-pa-md"},le={key:1,class:"row q-col-gutter-md"},oe={class:"col-6"},se={class:"text-h3 text-primary"},ne={class:"col-6"},ie={class:"text-h3 text-info"},de={class:"col-12"},re={class:"text-positive"},ue={class:"text-negative"},ce={class:"col-12 col-md-8"},fe={class:"pdf-container"},me={key:1,class:"iframe-container"},ve=["src"],_e=T({__name:"ProcessedDocumentDetailPage",setup(pe){const B=h(),V=O(),w=x(!0),b=x(!1),o=x(null),m=x({total_verifications:0,successful_verifications:0,failed_verifications:0,qr_scans:0,manual_verifications:0,last_verification:null}),j=l=>{if(!l)return"";try{return A.formatDate(new Date(l),"MMM D, YYYY")}catch{return console.warn("Invalid date format:",l),"Invalid date"}},k=l=>{if(!l)return"";try{return A.formatDate(new Date(l),"MMM D, YYYY h:mm A")}catch{return console.warn("Invalid datetime format:",l),"Invalid date/time"}},E=l=>{if(!l)return"";switch(l){case"approved":case"notarized":return"Approved";case"rejected":return"Rejected";default:return l.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}},F=l=>{switch(l){case"approved":case"notarized":return"positive";case"rejected":return"negative";default:return"grey"}},L=l=>{switch(l){case"approved":case"notarized":return"bg-positive text-white";case"rejected":return"bg-negative text-white";default:return"bg-grey-7 text-white"}},N=()=>{B.push("/notary/processed")},z=()=>{if(!!o.value)try{const l=q.downloadNotarizedDocument(o.value.notarized_id),a=window.document.createElement("a");a.href=l,a.target="_blank",a.download=`${o.value.document_title}.pdf`,window.document.body.appendChild(a),a.click(),window.document.body.removeChild(a)}catch(l){console.error("Error downloading document:",l),v.create({type:"negative",message:"Failed to download document"})}},C=async()=>{if(!!o.value){b.value=!0;try{const l=await q.getQrCodeStats(o.value.notarized_id);l.data.success?m.value=l.data.data||{total_verifications:0,successful_verifications:0,failed_verifications:0,qr_scans:0,manual_verifications:0,last_verification:null}:v.create({type:"negative",message:l.data.message||"Failed to load verification statistics"})}catch(l){console.error("Error loading QR stats:",l),v.create({type:"negative",message:"Failed to load verification statistics"})}finally{b.value=!1}}},M=async()=>{w.value=!0;try{const l=parseInt(V.params.id);if(isNaN(l))throw new Error("Invalid document ID");let a;try{console.log("Attempting to load notarized document with ID:",l),a=await q.getNotarizedDocument(l)}catch(R){console.warn("Could not find document as notarized_id, trying request_id",R),o.value=null,v.create({type:"negative",message:"Document not found. Please check if this is a valid notarized document."}),w.value=!1;return}a.data.success?(o.value=a.data.data,C()):(o.value=null,v.create({type:"negative",message:a.data.message||"Failed to load document details"}))}catch(l){console.error("Error loading document details:",l),o.value=null,v.create({type:"negative",message:"Failed to load document details"})}finally{w.value=!1}};return K(()=>{M()}),(l,a)=>(c(),p(U,{class:"processed-document-detail-page bg-grey-1"},{default:t(()=>[s("div",G,[s("div",J,[s("div",H,[s("div",W,[e(y,{flat:"",round:"",dense:"",color:"primary",icon:"fa-solid fa-arrow-left",onClick:N,class:"q-mr-sm"}),a[0]||(a[0]=s("h1",{class:"text-h5 q-my-none"},"Document Details",-1))]),a[1]||(a[1]=s("p",{class:"text-grey-8 q-mb-none"}," View details of processed document ",-1))]),s("div",X,[e(y,{outline:"",color:"primary",label:"Download",icon:"fa-solid fa-download","no-caps":"",onClick:z,class:"q-mr-sm"}),e(y,{unelevated:"",color:"primary",label:"Verification Stats",icon:"fa-solid fa-chart-pie","no-caps":"",onClick:C})])]),w.value?(c(),g("div",Z,[e(I,{color:"primary",size:"3em"}),a[2]||(a[2]=s("span",{class:"q-ml-sm text-primary"},"Loading document details...",-1))])):o.value?(c(),g("div",ee,[s("div",te,[e(_,{flat:"",bordered:""},{default:t(()=>[e(f,{class:$(L(o.value.status))},{default:t(()=>a[5]||(a[5]=[s("div",{class:"text-h6"},"Document Information",-1)])),_:1},8,["class"]),e(f,null,{default:t(()=>[e(D,{bordered:"",separator:""},{default:t(()=>[e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[6]||(a[6]=[i("Document Title")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.document_title),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[7]||(a[7]=[i("Document Number")])),_:1}),e(n,null,{default:t(()=>[e(P,{outline:"",color:"primary",class:"text-primary q-px-sm"},{default:t(()=>[i(d(o.value.document_number),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[8]||(a[8]=[i("Book/Page")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.book_number||"N/A")+"/"+d(o.value.page_number||"N/A"),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[9]||(a[9]=[i("Series Of")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.series_of||"N/A"),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[10]||(a[10]=[i("Status")])),_:1}),e(n,null,{default:t(()=>[e(P,{color:F(o.value.status),class:"q-px-sm"},{default:t(()=>[i(d(E(o.value.status)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[11]||(a[11]=[i("Document Type")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.certificate_type||"N/A"),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[12]||(a[12]=[i("Verification Key")])),_:1}),e(n,{class:"code-font"},{default:t(()=>[i(d(o.value.doc_keycode),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{flat:"",bordered:"",class:"q-mt-md"},{default:t(()=>[e(f,{class:"bg-primary text-white"},{default:t(()=>a[13]||(a[13]=[s("div",{class:"text-h6"},"Processing Information",-1)])),_:1}),e(f,null,{default:t(()=>[e(D,{bordered:"",separator:""},{default:t(()=>[e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[14]||(a[14]=[i("Requester")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.requester_name||"N/A"),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[15]||(a[15]=[i("Processed On")])),_:1}),e(n,null,{default:t(()=>[i(d(k(o.value.processed_at||o.value.notarization_date)),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[16]||(a[16]=[i("Location")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.notary_location||"N/A"),1)]),_:1})]),_:1})]),_:1}),o.value.expires_at?(c(),p(r,{key:0},{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[17]||(a[17]=[i("Expires On")])),_:1}),e(n,null,{default:t(()=>[i(d(j(o.value.expires_at)),1)]),_:1})]),_:1})]),_:1})):S("",!0),o.value.status==="rejected"?(c(),p(r,{key:1},{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[18]||(a[18]=[i("Rejection Reason")])),_:1}),e(n,null,{default:t(()=>[i(d(o.value.rejection_reason||"No reason provided"),1)]),_:1})]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1})]),_:1}),e(_,{flat:"",bordered:"",class:"q-mt-md"},{default:t(()=>[e(f,{class:"bg-info text-white"},{default:t(()=>a[19]||(a[19]=[s("div",{class:"text-h6"},"Verification Statistics",-1)])),_:1}),e(f,{class:"text-center"},{default:t(()=>[b.value?(c(),g("div",ae,[e(I,{color:"primary",size:"2em"}),a[20]||(a[20]=s("div",{class:"q-mt-sm"},"Loading statistics...",-1))])):(c(),g("div",le,[s("div",oe,[s("div",se,d(m.value.total_verifications||0),1),a[21]||(a[21]=s("div",{class:"text-caption"},"Total Verifications",-1))]),s("div",ne,[s("div",ie,d(m.value.qr_scans||0),1),a[22]||(a[22]=s("div",{class:"text-caption"},"QR Code Scans",-1))]),s("div",de,[e(D,{bordered:"",separator:""},{default:t(()=>[e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[23]||(a[23]=[i("Last Verified")])),_:1}),e(n,null,{default:t(()=>[i(d(m.value.last_verification?k(m.value.last_verification):"Never"),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[24]||(a[24]=[i("Successful / Failed")])),_:1}),e(n,null,{default:t(()=>[s("span",re,d(m.value.successful_verifications||0),1),a[25]||(a[25]=i(" / ")),s("span",ue,d(m.value.failed_verifications||0),1)]),_:1})]),_:1})]),_:1}),e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(n,{caption:""},{default:t(()=>a[26]||(a[26]=[i("Manual Verifications")])),_:1}),e(n,null,{default:t(()=>[i(d(m.value.manual_verifications||0),1)]),_:1})]),_:1})]),_:1})]),_:1})])]))]),_:1})]),_:1})]),s("div",ce,[e(_,{flat:"",bordered:"",class:"document-preview-card"},{default:t(()=>[e(f,{class:"bg-grey-3"},{default:t(()=>a[27]||(a[27]=[s("div",{class:"text-h6"},"Document Preview",-1)])),_:1}),e(f,{class:"q-pa-none"},{default:t(()=>[s("div",fe,[o.value.notarized_document_path?(c(),g("div",me,[s("iframe",{src:`${o.value.notarized_document_path}#toolbar=0&navpanes=0`,frameborder:"0"},null,8,ve)])):(c(),p(_,{key:0,flat:"",class:"text-center q-pa-xl"},{default:t(()=>[e(Q,{name:"fa-solid fa-file-pdf",size:"4em",color:"grey-5"}),a[28]||(a[28]=s("div",{class:"text-h6 q-mt-md"},"Preview Not Available",-1)),a[29]||(a[29]=s("p",{class:"text-grey-8"}," Document preview is not available. Please download the document to view it. ",-1)),e(y,{unelevated:"",color:"primary",label:"Download Document",icon:"fa-solid fa-download","no-caps":"",onClick:z,class:"q-mt-sm"})]),_:1}))])]),_:1})]),_:1})])])):(c(),p(_,{key:1,flat:"",bordered:"",class:"bg-white"},{default:t(()=>[e(f,{class:"text-center q-pa-xl"},{default:t(()=>[e(Q,{name:"fa-solid fa-file-circle-question",size:"3em",color:"grey-6"}),a[3]||(a[3]=s("div",{class:"text-h6 q-mt-md"},"Document Not Found",-1)),a[4]||(a[4]=s("p",{class:"text-grey-8"}," The document you are looking for could not be found or you do not have permission to access it. ",-1)),e(y,{outline:"",color:"primary",label:"Go Back",icon:"fa-solid fa-arrow-left","no-caps":"",class:"q-mt-sm",onClick:N})]),_:1})]),_:1}))])]),_:1}))}});var xe=Y(_e,[["__scopeId","data-v-522a1212"]]);export{xe as default};
