import{_ as B,d as $,c as A,r as g,o as E,j as f,k as v,w as t,az as M,aA as w,D as l,l as o,n as b,aB as n,t as r,aD as u,B as V,aC as Y,C as W,bv as j,bu as i,v as x,p as m,E as F}from"./index.72b13dbe.js";import{Q}from"./QTooltip.942d6901.js";import{d as L}from"./date.22c75b55.js";import{u as U}from"./notary.15f25e83.js";const G={class:"content-container q-pa-md"},H={class:"row items-center q-mb-md"},J={class:"col-auto"},K={class:"row q-col-gutter-md q-mb-md"},O={class:"col-12 col-sm-6 col-md-3"},X={class:"text-h4 text-weight-bold"},Z={class:"col-12 col-sm-6 col-md-3"},ee={class:"text-h4 text-weight-bold"},te={class:"col-12 col-sm-6 col-md-3"},ae={class:"text-h4 text-weight-bold"},se={class:"col-12 col-sm-6 col-md-3"},oe={class:"text-h4 text-weight-bold"},le={key:0,class:"q-pa-xl flex flex-center"},re={class:"text-primary"},ne={class:"text-caption"},ie=$({__name:"InboxPage",setup(ue){const h=A(),p=U(),d=g(!1),_=g(null),q=g([]),c=g({pending:0,completed_today:0,in_progress:0,avg_time:"0m"}),R=[{name:"request_reference",required:!0,label:"Reference",align:"left",field:"request_reference",sortable:!0},{name:"document_title",required:!0,label:"Document",align:"left",field:"document_title",sortable:!0},{name:"requester",label:"Requester",align:"left",field:"requester_name",sortable:!0},{name:"requested_at",label:"Requested",align:"left",field:"requested_at",sortable:!0},{name:"wait_time",label:"Wait Time",align:"center",field:"estimated_wait_time",sortable:!0},{name:"status",label:"Status",align:"center",field:"status",sortable:!0},{name:"actions",label:"Actions",align:"center",sortable:!1}],T=e=>e?L.formatDate(new Date(e),"MMM D, YYYY h:mm A"):"",D=e=>{if(!e||e<1)return"Immediate";if(e<60)return`${e}m`;const a=Math.floor(e/60),s=e%60;return`${a}h ${s}m`},P=e=>!e||e<5?"positive":e<15?"info":e<30?"warning":"negative",S=e=>{switch(e){case"pending":return"orange";case"assigned":return"blue";case"notarized":return"positive";case"rejected":return"negative";default:return"grey"}},I=e=>e?e.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"",y=async()=>{d.value=!0;try{await N();const e=await p.fetchQueue();q.value=e||[]}catch(e){console.error("Error loading queue:",e),w.create({type:"negative",message:"Failed to load queue"})}finally{d.value=!1}},N=async()=>{try{const e=await p.fetchDashboardStats();e&&(c.value=e)}catch(e){console.error("Error loading dashboard stats:",e)}},k=e=>{h.push(`/notary/requests/${e.request_id||e.queue_id}`)},z=async e=>{_.value=e.queue_id;try{const a=await p.acceptRequest(e.queue_id);a&&(w.create({type:"positive",message:"Request accepted successfully"}),h.push(`/notary/requests/${a.requestId}`))}catch(a){console.error("Error accepting request:",a),w.create({type:"negative",message:"Failed to accept request"})}finally{_.value=null}};return E(()=>{y()}),(e,a)=>(f(),v(M,{class:"notary-inbox-page bg-grey-1"},{default:t(()=>[l("div",G,[l("div",H,[a[0]||(a[0]=l("div",{class:"col"},[l("h1",{class:"text-h5 q-my-none"},"Notarization Queue"),l("p",{class:"text-grey-8 q-mb-none"}," Review and process document notarization requests ")],-1)),l("div",J,[o(b,{outline:"",color:"primary",label:"Refresh Queue",icon:"fa-solid fa-sync","no-caps":"",onClick:y,loading:d.value},null,8,["loading"])])]),l("div",K,[l("div",O,[o(u,{flat:"",class:"bg-primary text-white"},{default:t(()=>[o(n,null,{default:t(()=>[l("div",X,r(c.value.pending||0),1),a[1]||(a[1]=l("div",{class:"text-subtitle1"},"Pending Requests",-1))]),_:1})]),_:1})]),l("div",Z,[o(u,{flat:"",class:"bg-positive text-white"},{default:t(()=>[o(n,null,{default:t(()=>[l("div",ee,r(c.value.completed_today||0),1),a[2]||(a[2]=l("div",{class:"text-subtitle1"},"Completed Today",-1))]),_:1})]),_:1})]),l("div",te,[o(u,{flat:"",class:"bg-info text-white"},{default:t(()=>[o(n,null,{default:t(()=>[l("div",ae,r(c.value.in_progress||0),1),a[3]||(a[3]=l("div",{class:"text-subtitle1"},"In Progress",-1))]),_:1})]),_:1})]),l("div",se,[o(u,{flat:"",class:"bg-accent text-white"},{default:t(()=>[o(n,null,{default:t(()=>[l("div",oe,r(c.value.avg_time||"0m"),1),a[4]||(a[4]=l("div",{class:"text-subtitle1"},"Avg. Processing Time",-1))]),_:1})]),_:1})])]),d.value?(f(),V("div",le,[o(Y,{color:"primary",size:"3em"}),a[5]||(a[5]=l("span",{class:"q-ml-sm text-primary"},"Loading queue...",-1))])):q.value.length===0?(f(),v(u,{key:1,flat:"",class:"bg-white"},{default:t(()=>[o(n,{class:"text-center q-pa-xl"},{default:t(()=>[o(W,{name:"fa-solid fa-inbox",size:"3em",color:"grey-6"}),a[6]||(a[6]=l("div",{class:"text-h6 q-mt-md"},"Queue is Empty",-1)),a[7]||(a[7]=l("p",{class:"text-grey-8"}," There are no document requests awaiting notarization at this time. ",-1)),o(b,{outline:"",color:"primary",label:"Refresh Queue",icon:"fa-solid fa-sync","no-caps":"",class:"q-mt-sm",onClick:y})]),_:1})]),_:1})):(f(),v(u,{key:2,flat:"",class:"bg-white"},{default:t(()=>[o(n,{class:"q-pb-none"},{default:t(()=>a[8]||(a[8]=[l("div",{class:"text-h6"},"Pending Requests",-1),l("p",{class:"text-grey-8"}," The following documents are awaiting notarization. They are listed in order of submission. ",-1)])),_:1}),o(n,null,{default:t(()=>[o(j,{rows:q.value,columns:R,"row-key":"queue_id",pagination:{rowsPerPage:10},loading:d.value,class:"requests-table","no-data-label":"No requests found"},{"body-cell-request_reference":t(s=>[o(i,{props:s},{default:t(()=>[o(x,{outline:"",color:"primary",class:"text-primary q-px-sm"},{default:t(()=>[m(r(s.row.request_reference),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-document_title":t(s=>[o(i,{props:s,class:"cursor-pointer",onClick:C=>k(s.row)},{default:t(()=>[l("div",re,r(s.row.document_title),1),l("div",ne," Document: "+r(s.row.document_reference||"N/A"),1)]),_:2},1032,["props","onClick"])]),"body-cell-requester":t(s=>[o(i,{props:s},{default:t(()=>[l("div",null,r(s.row.requester_name||"Unknown"),1)]),_:2},1032,["props"])]),"body-cell-requested_at":t(s=>[o(i,{props:s},{default:t(()=>[l("div",null,r(T(s.row.requested_at)),1)]),_:2},1032,["props"])]),"body-cell-wait_time":t(s=>[o(i,{props:s},{default:t(()=>[o(x,{color:P(s.row.estimated_wait_time),class:"q-px-sm"},{default:t(()=>[m(r(D(s.row.estimated_wait_time)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-status":t(s=>[o(i,{props:s},{default:t(()=>[o(x,{color:S(s.row.status),class:"q-px-sm"},{default:t(()=>[m(r(I(s.row.status)),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-actions":t(s=>[o(i,{props:s,class:"q-gutter-x-sm"},{default:t(()=>[o(b,{flat:"",round:"",dense:"",color:"primary",icon:"fa-solid fa-eye",onClick:C=>k(s.row)},{default:t(()=>[o(Q,null,{default:t(()=>a[9]||(a[9]=[m("View Request")])),_:1})]),_:2},1032,["onClick"]),s.row.status==="pending"?(f(),v(b,{key:0,flat:"",round:"",dense:"",color:"positive",icon:"fa-solid fa-check",onClick:C=>z(s.row),disable:_.value===s.row.queue_id,loading:_.value===s.row.queue_id},{default:t(()=>[o(Q,null,{default:t(()=>a[10]||(a[10]=[m("Accept Request")])),_:1})]),_:2},1032,["onClick","disable","loading"])):F("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","loading"])]),_:1})]),_:1}))])]),_:1}))}});var _e=B(ie,[["__scopeId","data-v-36e66374"]]);export{_e as default};
